{"version":3,"sources":["lookup/components.js","tweets/buttons.js","lookup/lookup.js","tweets/list.js","tweets/tweet.js","tweets/components.js","App.js","serviceWorker.js","index.js"],"names":["backendLookup","method","url","callback","data","jsonData","JSON","stringify","xhr","XMLHttpRequest","endpoint","responseType","open","onload","response","status","setRequestHeader","onerror","e","send","ActionBtn","tweet","action","setNewTweet","setDidPerformAction","useState","likes","numberOfLikes","setNumberOfLikes","handleClick","event","preventDefault","tweetId","apiTweetAction","id","didPerformAction","alert","onClick","TweetsList","username","newTweet","tweets","setTweets","useEffect","apiTweetList","map","index","key","Tweet","parent","match","window","location","pathname","tweetIdPath","groups","isDetail","style","border","marginBottom","content","href","backgroundColor","TweetsComponent","canTweet","textAreaRef","useRef","createPermission","handleSubmit","useCallback","apiTweetCreate","current","value","onSubmit","ref","name","cols","rows","type","TweetDetailComponent","props","setTweet","App","Boolean","hostname","rootElement","document","getElementById","parse","dataset","ReactDOM","render","StrictMode","querySelectorAll","forEach","container","React","createElement","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.257e1760.chunk.js","sourcesContent":["\n\n/*const getCookie = (name) => {\n    var cookieValue = null;\n    if (document.cookie && document.cookie !== '') {\n        var cookies = document.cookie.split(';');\n        for (var i = 0; i < cookies.length; i++) {\n            var cookie = cookies[i].trim();\n            // Does this cookie string begin with the name we want?\n            if (cookie.substring(0, name.length + 1) === (name + '=')) {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n}*/\n\n\nexport const backendLookup = (method, url, callback, data) => {\n    let jsonData;\n    if (data) {\n        jsonData = JSON.stringify(data)\n    }\n    const xhr = new XMLHttpRequest()\n    const endpoint = `http://127.0.0.1:8000/api/tweets${url}`\n    const responseType = 'json'\n    xhr.responseType = responseType;\n    xhr.open(method, endpoint)\n    xhr.onload = function () {\n        callback(xhr.response, xhr.status)\n    }\n    xhr.setRequestHeader('Content-Type', 'application/json')\n    /*\n        const csrftoken = getCookie('csrftoken')\n        if (csrftoken) {\n        xhr.setRequestHeader('HTTP_X_REQUESTED_WITH', 'XMLHttpRequest')\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest')\n        xhr.setRequestHeader('X-CSRFToken', csrftoken)\n    }*/\n    xhr.onerror = function (e) {\n        callback({ 'message': 'Какая-то ошибка с запросом' }, 400)\n    }\n    xhr.send(jsonData)\n}\n\n\n","import React, { useState } from 'react';\nimport { apiTweetAction } from '../lookup';\n\nexport const ActionBtn = ({ tweet, action, setNewTweet, setDidPerformAction }) => {\n    const [numberOfLikes, setNumberOfLikes] = useState(tweet.likes)\n\n    const handleClick = (event) => {\n        event.preventDefault()\n        apiTweetAction(tweet.id, action, (response, status) => {\n            if (status === 200) {\n                setNumberOfLikes(response.likes)\n                setDidPerformAction(didPerformAction => !didPerformAction)\n            }\n            else if (status === 201) setNewTweet(response)\n            else alert('Что-то пошло не так. Попробуйте позже')\n        })\n    }\n\n    switch (action) {\n        case 'like':\n            return <button onClick={(event) => handleClick(event)}>{numberOfLikes} / Like</button>\n        case 'unlike':\n            return <button onClick={(event) => handleClick(event)}>{numberOfLikes} / Unlike</button>\n        case 'retweet':\n            return <button onClick={(event) => handleClick(event)}>Retweet</button>\n        default: return null\n    }\n}\n","import { backendLookup } from '../lookup'\n\nexport const apiTweetList = (callback,username) => {\n    let endpoint = '/'\n    if (username) {\n        endpoint = `/?username=${username}`\n    }\n    backendLookup('GET', endpoint, callback)\n}\n\nexport const apiTweetDetail = (callback, tweetId) => {\n    backendLookup('GET', `/${tweetId}`, callback)\n}\n\n\nexport const apiTweetCreate = (newTweet, callback) => {\n    const data = { 'content': newTweet }\n    backendLookup('POST', '/create/', callback, data)\n}\n\nexport const apiTweetAction = (tweetId, action, callback) => {\n    const data = { 'id': tweetId, 'action': action }\n    backendLookup('POST', '/action/', callback, data)\n}","import React, { useEffect, useState } from 'react';\nimport { apiTweetList } from '../lookup';\nimport { Tweet } from './index';\n\nexport const TweetsList = ({ username, newTweet, setNewTweet }) => {\n    const [tweets, setTweets] = useState([])\n    useEffect(() => {\n        const handleData = (response, status) => {\n            (status === 200\n                ? setTweets(response)\n                : alert('Что-то пошло не так. Попробуйте позже'))\n        }\n        apiTweetList(handleData, username)\n    }, [newTweet, username])\n    return tweets.map((tweet, index) => {\n        return <Tweet tweet={tweet} key={index} setNewTweet={setNewTweet} />\n    })\n}","import React, { useState } from 'react';\nimport { ActionBtn } from './buttons';\n\n\n\nexport const Tweet = ({ tweet, setNewTweet, parent }) => {\n    const [didPerformAction, setDidPerformAction] = useState(true)\n    var match = window.location.pathname.match(/(?<tweetId>\\d+)/)\n    var tweetIdPath = match ? match.groups.tweetId : null\n    const isDetail = tweetIdPath && tweetIdPath === `${tweet.id}` ? true : false\n\n\n    return <div style={{ border: '1px solid black', marginBottom: 20 }}>\n        {tweet.id} - {tweet.content}\n        {parent\n            ? null\n            : <>\n                {didPerformAction\n                    ? <ActionBtn setDidPerformAction={setDidPerformAction} tweet={tweet} action='like' />\n                    : <ActionBtn setDidPerformAction={setDidPerformAction} tweet={tweet} action='unlike' />}\n                <ActionBtn tweet={tweet} setNewTweet={setNewTweet} action='retweet' />\n            </>}\n        {isDetail ? null : <a href={`/${tweet.id}`}>Подробнее</a>}\n        {tweet.parent && <div style={{ backgroundColor: '#44ffa2' }}><Tweet tweet={tweet.parent} parent={tweet.parent} setNewTweet={setNewTweet} /></div>}\n    </div>\n}\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { apiTweetCreate, apiTweetDetail } from '../lookup';\nimport { TweetsList } from './list';\nimport { Tweet } from './tweet';\n\nexport const TweetsComponent = ({ username, canTweet }) => {\n    const textAreaRef = useRef()\n    const createPermission = canTweet === 'false' ? false : true\n    const [newTweet, setNewTweet] = useState([])\n    const handleSubmit = useCallback((event) => {\n        event.preventDefault()\n        apiTweetCreate(textAreaRef.current.value, (response, status) => {\n            (status === 201\n                ? setNewTweet(response)\n                : alert('Произошла ошибка. Попробуйте еще раз')\n            )\n        })\n        textAreaRef.current.value = ''\n    }, [])\n    return (\n        <>\n            {createPermission && <form onSubmit={handleSubmit}>\n                <textarea ref={textAreaRef} name=\"content\" id=\"content\" cols=\"30\" rows=\"10\"></textarea>\n                <button type=\"submit\">Добавить</button>\n            </form>}\n            <TweetsList username={username} newTweet={newTweet} setNewTweet={setNewTweet} />\n        </>\n    )\n}\n\nexport const TweetDetailComponent = (props) => {\n    const [tweet, setTweet] = useState(null)\n    useEffect(() => {\n        apiTweetDetail((response, status) => {\n            if (status === 200) {\n                setTweet(response)\n            } else {\n                alert('Какая-то ошибка с поиском вашего твита')\n            }\n        }, props.tweetId)\n    }, [])\n    return tweet === null ? null : <Tweet tweet={tweet} />\n}","import React from 'react';\nimport { TweetsComponent } from './tweets';\n\n\nconst App = ({data}) => {\n  return (\n    <>\n      <TweetsComponent username={data.username} canTweet={data.canTweet}/>\n    </>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport App from './App';\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\nimport { TweetDetailComponent } from './tweets';\n\n\nconst rootElement = document.getElementById('tweetme')\nconst data = JSON.parse(JSON.stringify(rootElement.dataset))\n\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserRouter>\n      <App data={data} />\n    </BrowserRouter>\n  </React.StrictMode>,\n  rootElement\n);\n\nconst tweetDetailElements = document.querySelectorAll('.tweetme-detail')\ntweetDetailElements.forEach(container => {\n  ReactDOM.render(\n    React.createElement(TweetDetailComponent, container.dataset),\n    container)\n})\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}